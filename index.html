<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>星际隧道动画</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden; /* 隐藏滚动条 */
            background-color: black;
        }
        canvas {
            display: block;
        }
    </style>
</head>
<body>

<canvas id="starfield"></canvas>

<script>
    const canvas = document.getElementById('starfield');
    const ctx = canvas.getContext('2d');

    let width, height, centerX, centerY;
    const stars = [];
    const starCount = 800; // 星星的数量
    const speed = 5;      // 飞行速度

    // 初始化画布尺寸
    function resize() {
        width = window.innerWidth;
        height = window.innerHeight;
        canvas.width = width;
        canvas.height = height;
        centerX = width / 2;
        centerY = height / 2;
    }

    // 创建星星对象
    class Star {
        constructor() {
            this.init();
        }

        init() {
            // 随机生成 X, Y, Z 坐标
            // Z 轴代表深度，越小代表离屏幕越近
            this.x = (Math.random() - 0.5) * 2000;
            this.y = (Math.random() - 0.5) * 2000;
            this.z = Math.random() * 2000;
            this.pz = this.z; // 记录上一帧的 Z 位置，用于画线
        }

        update() {
            this.pz = this.z;
            this.z -= speed; // Z 轴减小，星星向观众飞来

            // 如果星星飞出了屏幕，重新初始化到远处
            if (this.z < 1) {
                this.init();
                this.pz = this.z;
            }
        }

        draw() {
            // 将 3D 坐标投影到 2D 屏幕
            // 公式: 2D坐标 = 3D中心 + (3D坐标 / 深度)
            let sx = (this.x / this.z) * 500 + centerX;
            let sy = (this.y / this.z) * 500 + centerY;

            let px = (this.x / this.pz) * 500 + centerX;
            let py = (this.y / this.pz) * 500 + centerY;

            // 设置星星的亮度（越近越亮）
            const opacity = 1 - this.z / 2000;
            ctx.strokeStyle = `rgba(255, 255, 255, ${opacity})`;
            ctx.lineWidth = 2;

            // 画出运动轨迹（短线段，形成拉伸感）
            ctx.beginPath();
            ctx.moveTo(px, py);
            ctx.lineTo(sx, sy);
            ctx.stroke();
        }
    }

    // 创建星星数组
    for (let i = 0; i < starCount; i++) {
        stars.push(new Star());
    }

    // 动画循环
    function animate() {
        // 每帧涂一层半透明黑，可以产生轻微的拖影效果
        ctx.fillStyle = 'black';
        ctx.fillRect(0, 0, width, height);

        stars.forEach(star => {
            star.update();
            star.draw();
        });

        requestAnimationFrame(animate);
    }

    window.addEventListener('resize', resize);
    resize();
    animate();
</script>

</body>
</html>